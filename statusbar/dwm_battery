#!/bin/sh

case "$BLOCK_BUTTON" in
4) light -A 5 ;;
5) light -U 5 ;;
6) "$TERMINAL" -e "$EDITOR" "$0" ;;
esac

# ‰øÆÊîπÁîµÊ±†Ê†áËØÜÁ¨¶‰∏∫‰Ω†ÁöÑÂÆûÈôÖÂÄºÔºàÈÄöÂ∏∏‰∏∫ BAT0 Êàñ BAT1Ôºâ
CAPACITY=$(cat /sys/class/power_supply/BAT0/capacity)
STATUS=$(cat /sys/class/power_supply/BAT0/status)

printf "%s" "$SEP1"
if [ "$IDENTIFIER" = "unicode" ]; then
  case "$STATUS" in
  "Not charging") printf "üîå %s%%" "$CAPACITY" ;;
  *) printf "üîã %s%%" "$CAPACITY" ;;
  esac
else
  case "$STATUS" in
  "Discharging")
    # ÊîæÁîµÁä∂ÊÄÅÂõæÊ†áÊï∞ÁªÑÔºàÁ¥¢Âºï 0~10 ÂØπÂ∫î 0%~100%Ôºâ
    DISCHARGE_ICONS="Û±âû Û∞Å∫ Û∞Åª Û∞Åº Û∞ÅΩ Û∞Åæ Û∞Åø Û∞ÇÄ Û∞ÇÅ Û∞ÇÇ Û∞Åπ"
    if [ "$CAPACITY" -eq 100 ]; then
      icon=$(echo "$DISCHARGE_ICONS" | cut -d ' ' -f 11) # 100% ÁâπÊÆäÂ§ÑÁêÜ
    else
      index=$(((CAPACITY - 1) / 10)) # ËÆ°ÁÆóÁ¥¢Âºï (0~9)
      icon=$(echo "$DISCHARGE_ICONS" | cut -d ' ' -f $((index + 1)))
    fi
    printf "%s %s%%" "$icon" "$CAPACITY"
    [ "$CAPACITY" -le 10 ] && notify-send "Ê≤°Áîµ‰∫ÜÔºåËµ∂Á¥ßÂÖÖÁîµÂïäÔºÅÔºÅÔºÅ"
    ;;

  "Charging")
    # ÂÖÖÁîµÁä∂ÊÄÅÂõæÊ†áÊï∞ÁªÑÔºàÁ¥¢Âºï 0~9 ÂØπÂ∫î 0%~100%Ôºâ
    CHARGE_ICONS="Ó¨≠Û∞¢ü Ó¨≠Û∞¢ú Ó¨≠Û∞ÇÜ Ó¨≠Û∞Çá Ó¨≠Û∞Çà Ó¨≠Û∞¢ù Ó¨≠Û∞Çâ Ó¨≠Û∞¢û Ó¨≠Û∞Çä Ó¨≠Û∞Çã"
    index=$((CAPACITY / 10))         # ËÆ°ÁÆóÁ¥¢Âºï (0~10)
    index=$((index > 9 ? 9 : index)) # ÈôêÂà∂ÊúÄÂ§ßÁ¥¢Âºï‰∏∫9
    icon=$(echo "$CHARGE_ICONS" | cut -d ' ' -f $((index + 1)))
    printf "%s %s%%" "$icon" "$CAPACITY"
    ;;

  "Not charging")
    printf "ÔÜ∏ %s%%" "$CAPACITY"
    ;;

  *)
    printf "Ó¨≠Û∞ÇÖ %s%%" "$CAPACITY"
    ;;
  esac
fi
printf "%s\n" "$SEP2"
